(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();const Gn="modulepreload",Yn=function(e){return"/pentagram/"+e},_t={},ae=function(t,n,i){let r=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),a=s?.nonce||s?.getAttribute("nonce");r=Promise.allSettled(n.map(c=>{if(c=Yn(c),c in _t)return;_t[c]=!0;const l=c.endsWith(".css"),u=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const d=document.createElement("link");if(d.rel=l?"stylesheet":Gn,l||(d.as="script"),d.crossOrigin="",d.href=c,a&&d.setAttribute("nonce",a),document.head.appendChild(d),l)return new Promise((h,p)=>{d.addEventListener("load",h),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function o(s){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s}return r.then(s=>{for(const a of s||[])a.status==="rejected"&&o(a.reason);return t().catch(o)})};document.addEventListener("alpine:init",()=>{Alpine.data("pentagramApp",()=>({username:Alpine.$persist("").as("pentagram-username"),identity:Alpine.$persist(null).as("pentagram-identity"),recentRooms:Alpine.$persist([]).as("pentagram-recent-rooms"),roomId:"",roomPassword:"",isConnected:!1,connectionStatus:"disconnected",peers:new Map,messages:[],messageInput:"",isVoiceActive:!1,isMuted:!1,isSpeaking:!1,roomManager:null,cryptoManager:null,storageManager:null,audioManager:null,announcementTimer:null,announcementInterval:3e4,peerPingTimer:null,peerPingInterval:15e3,notification:{show:!1,message:""},sendMessage:null,sendUserInfo:null,sendTyping:null,sendVoiceStatus:null,sendPing:null,sendPong:null,async init(){console.log("Pentagram.foo initializing..."),await this.initializeServices(),await this.initializeIdentity(),this.loadRoomFromURL(),this.handleSharedData(),console.log("Initialization complete"),console.log("Username:",this.username),console.log("Room ID from URL:",this.roomId),console.log("Identity:",this.identity?"loaded":"none"),this.username||this.showNotification("Welcome to Pentagram.foo! Choose a username to get started.")},async initializeServices(){try{const{CryptoManager:e}=await ae(async()=>{const{CryptoManager:r}=await import("./crypto-utils-BdLJwgD2.js");return{CryptoManager:r}},[]),{StorageManager:t}=await ae(async()=>{const{StorageManager:r}=await import("./storage-manager-UAozfZN9.js");return{StorageManager:r}},[]),{RoomManager:n}=await ae(async()=>{const{RoomManager:r}=await import("./room-manager-B7hmD9XC.js");return{RoomManager:r}},[]),{AudioManager:i}=await ae(async()=>{const{AudioManager:r}=await import("./audio-manager-RwarMdbY.js");return{AudioManager:r}},[]);this.cryptoManager=new e,this.storageManager=new t,this.roomManager=new n,this.audioManager=new i,await this.audioManager.init(),this.setupRoomManagerCallbacks(),console.log("Services initialized")}catch(e){console.error("Failed to initialize services:",e),this.showNotification("Failed to initialize services",5e3)}},setupRoomManagerCallbacks(){this.roomManager&&(this.roomManager.onPeerJoin(e=>{console.log("App: Peer joined:",e),this.peers.set(e,{id:e,username:null,publicKey:null,joinedAt:Date.now(),lastSeen:Date.now(),responsive:!0,latency:null,isTyping:!1}),this.sendUserInfo&&this.sendUserInfo({username:this.username,publicKey:this.identity.publicKey,joinedAt:Date.now()},e),this.audioManager&&this.audioManager.localStream&&this.audioManager.isActive&&(console.log(`Sending audio stream to new peer: ${e}`),setTimeout(()=>{this.roomManager.addStream(this.audioManager.localStream,e,{type:"audio",username:this.username})},100))}),this.roomManager.onPeerLeave(e=>{console.log("App: Peer left:",e),this.peers.delete(e)}),this.roomManager.onConnectionStatus(e=>{console.log("App: Connection status changed:",e);const t=this.connectionStatus==="reconnecting";e==="connected"?(this.isConnected=!0,this.connectionStatus="connected",t&&this.showNotification("Connection restored!")):e==="disconnected"?(this.isConnected=!1,this.connectionStatus="disconnected",this.peers.clear(),this.messages=[]):e==="reconnecting"?(this.isConnected=!1,this.connectionStatus="reconnecting",this.showNotification("Reconnecting...",0)):e==="stable"?(this.connectionStatus="stable",this.showNotification("Connection is stable",2e3)):e==="failed"&&(this.connectionStatus="disconnected",this.showNotification("Failed to connect to P2P network",5e3))}),this.roomManager.onReconnected(()=>{console.log("App: Reconnected - re-announcing presence"),this.reannouncePresence()}))},async initializeIdentity(){if(!this.cryptoManager){console.warn("CryptoManager not available");return}try{if(this.identity)console.log("Loading existing identity..."),await this.cryptoManager.loadKeyPair(this.identity),console.log("Identity loaded:",this.cryptoManager.getPublicKeyFingerprint());else{console.log("Generating new identity...");const e=await this.cryptoManager.generateKeyPair();this.identity={publicKey:Array.from(e.publicKey),privateKey:Array.from(e.privateKey),created:e.created},console.log("New identity created:",this.cryptoManager.getPublicKeyFingerprint()),this.showNotification("New cryptographic identity created",3e3)}}catch(e){console.error("Identity initialization failed:",e),this.showNotification("Failed to initialize identity",5e3)}},loadRoomFromURL(){const t=window.location.hash.match(/#\/room\/([^?]+)(\?password=(.+))?/);t&&(this.roomId=decodeURIComponent(t[1]),this.roomPassword=t[3]?decodeURIComponent(t[3]):"",console.log(`Room loaded from URL: ${this.roomId}`))},handleSharedData(){const e=new URLSearchParams(window.location.search),t=e.get("url")||e.get("text")||e.get("title");if(t)try{const r=new URL(t).hash.match(/#\/room\/([^?]+)(\?password=(.+))?/);r&&(this.roomId=decodeURIComponent(r[1]),this.roomPassword=r[3]?decodeURIComponent(r[3]):"",console.log(`Room loaded from shared URL: ${this.roomId}`),this.showNotification("Room link loaded from share.",3e3))}catch(n){console.warn("Could not parse shared URL:",n)}},async joinRoom(){if(!this.username.trim()||!this.roomId.trim())return this.showNotification("Please enter both username and room name"),!1;if(!this.roomManager||!this.cryptoManager)return this.showNotification("Services not ready, please wait..."),!1;console.log(`Attempting to join room: ${this.roomId} as ${this.username}`),this.connectionStatus="connecting";try{const e=await this.roomManager.joinRoom(this.roomId,this.roomPassword||null,t=>{console.error("Room join error:",t),this.showNotification("Failed to join room: "+t.message),this.connectionStatus="disconnected"});return this.setupCommunicationActions(e),this.roomManager&&this.sendUserInfo&&this.roomManager.setUserInfo(this.username,this.identity,this.sendUserInfo),this.isConnected=!0,this.connectionStatus="connected",this.addToRecentRooms(),this.updateURL(),this.showNotification(`Connected to room: ${this.roomId}`),console.log("Room joined successfully"),this.startPeriodicAnnouncements(),this.startPeerPinging(),!0}catch(e){return console.error("Failed to join room:",e),this.connectionStatus="disconnected",this.showNotification("Failed to connect to P2P network"),!1}},setupCommunicationActions(e){try{const[t,n]=e.makeAction("message");this.sendMessage=t,n((p,v)=>{this.handleIncomingMessage(p,v)});const[i,r]=e.makeAction("userInfo");this.sendUserInfo=i,r((p,v)=>{this.handleUserInfo(p,v)});const[o,s]=e.makeAction("typing");this.sendTyping=o,s((p,v)=>{this.handleTypingStatus(p,v)});const[a,c]=e.makeAction("voiceStatus");this.sendVoiceStatus=a,c((p,v)=>{this.handleVoiceStatus(p,v)});const[l,u]=e.makeAction("ping"),[d,h]=e.makeAction("pong");this.sendPing=l,this.sendPong=d,u((p,v)=>{this.handlePeerPing(p,v)}),h((p,v)=>{this.handlePeerPong(p,v)}),console.log("Communication actions setup complete")}catch(t){console.error("Failed to setup communication actions:",t),this.showNotification("Failed to setup peer communication")}},async handleIncomingMessage(e,t){try{const n=this.peers.get(t);if(!n?.publicKey){console.warn("Received message from unknown peer:",t);return}if(!await this.cryptoManager.verifyMessage(e.content,e.signature,n.publicKey)){console.warn("Invalid message signature from:",t);return}this.messages.push({id:e.id,content:e.content,username:n.username||t.substring(0,8),peerId:t,timestamp:e.timestamp,verified:!0,self:!1}),this.$nextTick(()=>{const r=document.getElementById("messages-container");r&&(r.scrollTop=r.scrollHeight)})}catch(n){console.error("Failed to handle incoming message:",n)}},handleUserInfo(e,t){const n=this.peers.get(t);n&&(n.username=e.username,n.publicKey=e.publicKey,n.lastSeen=Date.now(),this.peers.set(t,n),console.log(`Updated peer info for ${t}: ${e.username}`))},handlePeerPing(e,t){if(this.sendPong){this.sendPong({id:e.id,timestamp:Date.now(),username:this.username,status:"active"},t);const n=this.peers.get(t);n&&(n.lastSeen=Date.now(),n.responsive=!0,this.peers.set(t,n)),console.log(`Received ping from ${n?.username||t}, sent pong`)}},handlePeerPong(e,t){const n=this.peers.get(t);if(n){const i=Date.now()-e.timestamp;n.lastSeen=Date.now(),n.responsive=!0,n.latency=i,this.peers.set(t,n),console.log(`Received pong from ${n.username||t}, RTT: ${i}ms`)}},handleTypingStatus(e,t){const n=this.peers.get(t);n&&(n.isTyping=e,this.peers.set(t,n))},handleVoiceStatus(e,t){const n=this.peers.get(t);n&&(n.voiceStatus={isActive:e.isActive||!1,isMuted:e.isMuted||!1,isSpeaking:e.isSpeaking||!1,lastUpdate:Date.now()},this.peers.set(t,n),console.log(`Voice status update for ${n.username||t}:`,n.voiceStatus))},async leaveRoom(){console.log("Leaving room..."),this.roomManager&&await this.roomManager.leaveRoom(),this.isConnected=!1,this.connectionStatus="disconnected",this.peers.clear(),this.messages=[],this.roomId="",this.roomPassword="",this.sendMessage=null,this.sendUserInfo=null,this.sendTyping=null,this.sendVoiceStatus=null,this.sendPing=null,this.sendPong=null,this.stopPeriodicAnnouncements(),this.stopPeerPinging(),window.history.replaceState({},"",window.location.pathname),this.showNotification("Left room")},async sendChatMessage(e){if(!(!e||!e.trim())){if(!this.isConnected||!this.sendMessage||!this.cryptoManager){this.showNotification("Not connected to room");return}try{const t=e.trim(),n=await this.cryptoManager.signMessage(t),i={id:crypto.randomUUID(),content:t,username:this.username,timestamp:Date.now(),signature:Array.from(n)};await this.sendMessage(i),this.messages.push({...i,peerId:"self",verified:!0,self:!0}),console.log("Message sent:",t),this.$nextTick(()=>{const r=document.getElementById("messages-container");r&&(r.scrollTop=r.scrollHeight)})}catch(t){console.error("Failed to send message:",t),this.showNotification("Failed to send message")}}},handleTyping(){console.log("User is typing...")},async copyRoomLink(){const e=this.getRoomShareLink();try{await navigator.clipboard.writeText(e),this.showNotification("Room link copied to clipboard!")}catch(t){console.error("Failed to copy link:",t),this.showNotification("Failed to copy link")}},getRoomShareLink(){if(!this.roomId)return"";const e=`${window.location.origin}${window.location.pathname}#/room/${encodeURIComponent(this.roomId)}`;return this.roomPassword?`${e}?password=${encodeURIComponent(this.roomPassword)}`:e},addToRecentRooms(){const e={id:this.roomId,name:this.roomId,lastVisited:Date.now(),hasPassword:!!this.roomPassword};this.recentRooms=this.recentRooms.filter(t=>t.id!==this.roomId),this.recentRooms.unshift(e),this.recentRooms.length>10&&(this.recentRooms=this.recentRooms.slice(0,10))},updateURL(){if(!this.roomId)return;const e=`${window.location.origin}${window.location.pathname}#/room/${encodeURIComponent(this.roomId)}`,t=this.roomPassword?`${e}?password=${encodeURIComponent(this.roomPassword)}`:e;window.history.replaceState({},"",t)},showNotification(e,t=3e3){this.notification.message=e,this.notification.show=!0,setTimeout(()=>{this.notification.show=!1},t)},exportIdentity(){if(!this.cryptoManager||!this.username){this.showNotification("No identity to export");return}try{const e=this.cryptoManager.exportIdentity(this.username),t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),n=URL.createObjectURL(t),i=document.createElement("a");i.href=n,i.download=`pentagram-identity-${this.username}-${Date.now()}.json`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(n),this.showNotification("Identity exported successfully")}catch(e){console.error("Export failed:",e),this.showNotification("Failed to export identity")}},async importIdentity(e){if(!this.cryptoManager){this.showNotification("Crypto services not available");return}try{const t=await e.text(),n=JSON.parse(t),i=await this.cryptoManager.importIdentity(n);i&&(this.username=i),this.identity=n.identity,this.showNotification("Identity imported successfully"),console.log("Identity imported:",this.cryptoManager.getPublicKeyFingerprint())}catch(t){console.error("Import failed:",t),this.showNotification("Failed to import identity")}},async clearData(){if(confirm("This will delete all your data including your identity. Are you sure?"))try{this.username="",this.identity=null,this.recentRooms=[],this.storageManager&&this.storageManager.clearAll(),this.cryptoManager=null,await this.initializeServices(),await this.initializeIdentity(),this.showNotification("All data cleared, new identity created")}catch(e){console.error("Failed to clear data:",e),this.showNotification("Failed to clear data")}},reannouncePresence(){if(!this.sendUserInfo||!this.identity||!this.username){console.warn("Cannot re-announce: missing sendUserInfo, identity, or username");return}try{this.sendUserInfo({username:this.username,publicKey:this.identity.publicKey,joinedAt:Date.now(),reconnected:!0}),console.log("Re-announced presence to all peers after reconnection"),this.showNotification("Restored visibility to other users",2e3)}catch(e){console.error("Failed to re-announce presence:",e)}},getIdentityInfo(){return!this.cryptoManager||!this.identity?null:{fingerprint:this.cryptoManager.getPublicKeyFingerprint(),userId:this.cryptoManager.getUserId(),publicKeyHex:this.cryptoManager.getPublicKeyHex(),created:this.identity.created?new Date(this.identity.created).toLocaleString():"Unknown"}},startPeriodicAnnouncements(){this.announcementTimer&&clearInterval(this.announcementTimer),console.log("Starting periodic peer discovery announcements"),this.announcementTimer=setInterval(async()=>{if(this.isConnected&&this.roomManager)try{const e=await this.roomManager.forceAnnounceToTrackers();e&&console.log(`Announced to ${e.connectedTrackers}/${e.totalTrackers} trackers`);const t=this.roomManager.getDetailedConnectionStatus();console.log("Peer discovery status:",t),t.peers===0&&t.connectedTrackers>0&&console.log("No peers found yet, but connected to trackers. Waiting for peer discovery...")}catch(e){console.error("Periodic announcement failed:",e)}},this.announcementInterval),this.roomManager&&this.isConnected&&setTimeout(()=>{this.roomManager.forceAnnounceToTrackers()},2e3)},stopPeriodicAnnouncements(){this.announcementTimer&&(clearInterval(this.announcementTimer),this.announcementTimer=null,console.log("Stopped periodic announcements"))},startPeerPinging(){this.peerPingTimer&&clearInterval(this.peerPingTimer),console.log("Starting periodic peer pinging"),this.peerPingTimer=setInterval(()=>{if(this.isConnected&&this.sendPing&&this.peers.size>0){for(const[e,t]of this.peers)if(e!=="self"){const i={id:crypto.randomUUID(),timestamp:Date.now(),username:this.username};this.sendPing(i,e),console.log(`Sent ping to ${t.username||e}`);const r=Date.now()-(t.lastSeen||0);r>6e4&&(t.responsive=!1,this.peers.set(e,t),console.warn(`Peer ${t.username||e} may be unresponsive (${Math.round(r/1e3)}s since last seen)`))}}},this.peerPingInterval)},stopPeerPinging(){this.peerPingTimer&&(clearInterval(this.peerPingTimer),this.peerPingTimer=null,console.log("Stopped peer pinging"))},getConnectionDebugInfo(){if(!this.roomManager)return"Room manager not available";const e=this.roomManager.getDetailedConnectionStatus();return console.log("=== CONNECTION DEBUG INFO ==="),console.log("Self ID:",e.selfId),console.log("Connected to room:",e.room),console.log("Peers found:",e.peers),console.log("Peer IDs:",e.peerIds),console.log("Tracker connections:",e.connectedTrackers+"/"+e.totalTrackers),console.log("Trackers:",e.trackers),console.log("==============================="),e}}))});document.addEventListener("alpine:init",()=>{Alpine.data("connectionStatus",()=>({trackers:[],connectionQuality:"unknown",isReconnecting:!1,lastUpdate:null,init(){console.log("Connection status component initialized"),this.updateInterval=setInterval(()=>{this.updateConnectionStatus()},5e3),this.updateConnectionStatus()},updateConnectionStatus(){this.lastUpdate=Date.now();try{const e=document.querySelector('[x-data="pentagramApp"]');if(e&&e._x_dataStack){const t=e._x_dataStack[0];if(t&&t.roomManager){const n=t.roomManager.getTrackerStatus();this.trackers=n,t.connectionStatus==="connected"&&n.length>0?(this.isReconnecting=!1,this.assessConnectionQuality()):t.connectionStatus==="connecting"?(this.isReconnecting=!1,this.connectionQuality="poor"):t.connectionStatus==="reconnecting"?(this.isReconnecting=!0,this.connectionQuality="poor"):t.connectionStatus==="stable"?(this.isReconnecting=!1,this.connectionQuality="excellent"):(this.isReconnecting=!1,this.connectionQuality="unknown")}else this.connectionQuality="unknown",this.trackers=[]}}catch(e){console.warn("Failed to update connection status:",e),this.connectionQuality="unknown"}},assessConnectionQuality(){if(!this.trackers.length){this.connectionQuality="unknown";return}const e=this.trackers.filter(i=>i.connected).length,t=this.trackers.length,n=e/t;n>=.8?this.connectionQuality="excellent":n>=.6?this.connectionQuality="good":n>=.3?this.connectionQuality="fair":this.connectionQuality="poor"},get connectionColorClass(){const e={unknown:"bg-gray-500",poor:this.isReconnecting?"bg-orange-500":"bg-red-500",fair:"bg-yellow-500",good:"bg-blue-500",excellent:"bg-green-500"};return e[this.connectionQuality]||e.unknown},get connectionStatusClass(){return this.isReconnecting?"animate-pulse":""},get connectionText(){return this.isReconnecting?"Reconnecting...":this.connectionQuality.charAt(0).toUpperCase()+this.connectionQuality.slice(1)},destroy(){this.updateInterval&&clearInterval(this.updateInterval)}}))});document.addEventListener("alpine:init",()=>{Alpine.data("voiceControls",()=>({isVoiceActive:!1,isMuted:!1,isSpeaking:!1,currentVolume:0,voiceError:null,showDeviceSelector:!1,availableDevices:[],currentDevice:null,permissionState:"unknown",broadcastInterval:null,broadcastFrequency:5e3,init(){console.log("Voice controls component initialized"),this.setupAppConnection(),this.checkMicrophonePermission(),this.setupPeerJoinListener(),this.startPeriodicBroadcasting()},setupAppConnection(){const e=document.querySelector('[x-data*="pentagramApp"]');e&&e._x_dataStack&&(this.app=e._x_dataStack[0],this.app&&this.app.audioManager&&this.setupAudioCallbacks(),this.syncVoiceStateWithApp())},syncVoiceStateWithApp(){this.app&&(this.app.isVoiceActive=this.isVoiceActive,this.app.isMuted=this.isMuted,this.app.isSpeaking=this.isSpeaking)},setupAudioCallbacks(){const e=this.app.audioManager;e.onVolumeUpdate(t=>{this.currentVolume=t.volume,this.isSpeaking=t.isSpeaking&&!t.isMuted,this.isMuted=t.isMuted,this.syncVoiceStateWithApp(),this.app.isConnected&&t.speakingChanged&&this.broadcastVoiceActivity()}),e.onDeviceChange(async()=>{await this.updateAvailableDevices()}),e.onError((t,n)=>{this.handleVoiceError(t,n)})},async checkMicrophonePermission(){try{if(navigator.permissions){const e=await navigator.permissions.query({name:"microphone"});this.permissionState=e.state,e.addEventListener("change",()=>{this.permissionState=e.state})}}catch(e){console.warn("Could not check microphone permission:",e)}},async toggleVoice(){if(!this.app||!this.app.audioManager){console.error("Audio manager not available");return}const e=this.app.audioManager;this.voiceError=null;try{if(this.isVoiceActive)e.stopVoiceChat(),this.app.roomManager&&this.app.roomManager.isRoomConnected()&&this.app.roomManager.removeStream(e.localStream),this.isVoiceActive=!1,this.isMuted=!1,this.isSpeaking=!1,this.currentVolume=0,this.syncVoiceStateWithApp(),this.broadcastVoiceActivity(),console.log("Voice chat stopped");else{console.log("Starting voice chat...");const t=await e.startVoiceChat();this.app.roomManager&&this.app.roomManager.isRoomConnected()&&(this.app.roomManager.addStream(t,null,{type:"audio",username:this.app.username}),console.log("Audio stream added to room")),this.isVoiceActive=!0,this.syncVoiceStateWithApp(),await this.updateAvailableDevices(),this.broadcastVoiceActivity(),console.log("Voice chat started")}}catch(t){console.error("Voice toggle failed:",t),this.handleVoiceError("toggle",t)}},toggleMute(){if(!this.app||!this.app.audioManager||!this.isVoiceActive)return;const e=this.isMuted;this.isMuted=this.app.audioManager.toggleMute(),this.syncVoiceStateWithApp(),e!==this.isMuted&&this.broadcastVoiceActivity(),console.log(`Microphone ${this.isMuted?"muted":"unmuted"}`)},broadcastVoiceActivity(){if(!(!this.app.isConnected||!this.app.sendVoiceStatus))try{this.app.sendVoiceStatus({isActive:this.isVoiceActive,isMuted:this.isMuted,isSpeaking:this.isSpeaking&&!this.isMuted,username:this.app.username,timestamp:Date.now()})}catch(e){console.warn("Failed to broadcast voice activity:",e)}},async updateAvailableDevices(){if(!(!this.app||!this.app.audioManager))try{this.availableDevices=await this.app.audioManager.getAudioDevices(),this.availableDevices.length>0&&!this.currentDevice&&(this.currentDevice=this.availableDevices[0].deviceId)}catch(e){console.error("Failed to update audio devices:",e)}},async switchAudioDevice(e){if(!(!this.app||!this.app.audioManager))try{if(await this.app.audioManager.switchAudioDevice(e)&&(this.currentDevice=e,this.showDeviceSelector=!1,this.app.roomManager&&this.app.roomManager.isRoomConnected())){const n=this.app.audioManager.localStream;this.app.roomManager.removeStream(n),this.app.roomManager.addStream(n,null,{type:"audio",username:this.app.username})}}catch(t){console.error("Failed to switch audio device:",t),this.handleVoiceError("device_switch",t)}},handleVoiceError(e,t){let n="Voice chat error";switch(e){case"permission_denied":n="Microphone access denied. Please allow microphone access to use voice chat.",this.permissionState="denied";break;case"device_not_found":n="No microphone found. Please connect a microphone to use voice chat.";break;case"constraints_not_satisfied":n="Microphone constraints not satisfied. Please try a different device.";break;case"device_switch":n="Failed to switch microphone device.";break;case"toggle":n="Failed to toggle voice chat.";break;default:n=`Voice error: ${t.message||"Unknown error"}`}this.voiceError=n,console.error("Voice error:",e,t),setTimeout(()=>{this.voiceError=null},5e3)},get voiceButtonIcon(){return this.isVoiceActive?this.isMuted?"ðŸŽ¤ðŸš«":this.isSpeaking?"ðŸŽ¤ðŸ“¢":"ðŸŽ¤âœ…":"ðŸŽ¤"},get voiceButtonColorClass(){return this.isVoiceActive?this.isMuted?"bg-red-500 hover:bg-red-600":this.isSpeaking?"bg-green-500 hover:bg-green-600 animate-pulse":"bg-blue-500 hover:bg-blue-600":"bg-gray-500 hover:bg-gray-600"},get voiceButtonTitle(){return this.isVoiceActive?this.isMuted?"Unmute microphone":"Mute microphone":"Start voice chat"},get volumeBarWidth(){return Math.min(100,Math.max(0,this.currentVolume*2))},get deviceSelectorText(){if(!this.currentDevice)return"Select Microphone";const e=this.availableDevices.find(t=>t.deviceId===this.currentDevice);return e?e.label:"Unknown Device"},get needsPermission(){return this.permissionState==="denied"||!this.isVoiceActive&&this.permissionState==="prompt"},setupPeerJoinListener(){setTimeout(()=>{if(this.app&&this.app.roomManager){const e=this.app.roomManager.onPeerJoinCallback;this.app.roomManager.onPeerJoin(t=>{e&&e(t),this.isVoiceActive&&(console.log(`Broadcasting voice status to new peer: ${t}`),this.broadcastVoiceActivityToPeer(t),this.app.audioManager&&this.app.audioManager.localStream&&setTimeout(()=>{this.app.roomManager.addStream(this.app.audioManager.localStream,t,{type:"audio",username:this.app.username}),console.log(`Audio stream sent to new peer: ${t}`)},100))})}},500)},startPeriodicBroadcasting(){this.broadcastInterval&&clearInterval(this.broadcastInterval),this.broadcastInterval=setInterval(()=>{this.isVoiceActive&&this.app&&this.app.isConnected&&this.broadcastVoiceActivity()},this.broadcastFrequency),console.log("Periodic voice status broadcasting started")},broadcastVoiceActivityToPeer(e){if(!(!this.app.isConnected||!this.app.sendVoiceStatus))try{this.app.sendVoiceStatus({isActive:this.isVoiceActive,isMuted:this.isMuted,isSpeaking:this.isSpeaking&&!this.isMuted,username:this.app.username,timestamp:Date.now()},e)}catch(t){console.warn("Failed to broadcast voice activity to peer:",e,t)}},destroy(){this.broadcastInterval&&(clearInterval(this.broadcastInterval),this.broadcastInterval=null),this.isVoiceActive&&this.app&&this.app.audioManager&&this.app.audioManager.stopVoiceChat()}}))});var Te=!1,Oe=!1,N=[],ke=-1;function Xn(e){Zn(e)}function Zn(e){N.includes(e)||N.push(e),ti()}function ei(e){let t=N.indexOf(e);t!==-1&&t>ke&&N.splice(t,1)}function ti(){!Oe&&!Te&&(Te=!0,queueMicrotask(ni))}function ni(){Te=!1,Oe=!0;for(let e=0;e<N.length;e++)N[e](),ke=e;N.length=0,ke=-1,Oe=!1}var z,j,W,Nt,$e=!0;function ii(e){$e=!1,e(),$e=!0}function ri(e){z=e.reactive,W=e.release,j=t=>e.effect(t,{scheduler:n=>{$e?Xn(n):n()}}),Nt=e.raw}function yt(e){j=e}function oi(e){let t=()=>{};return[i=>{let r=j(i);return e._x_effects||(e._x_effects=new Set,e._x_runEffects=()=>{e._x_effects.forEach(o=>o())}),e._x_effects.add(r),t=()=>{r!==void 0&&(e._x_effects.delete(r),W(r))},r},()=>{t()}]}function Dt(e,t){let n=!0,i,r=j(()=>{let o=e();JSON.stringify(o),n?i=o:queueMicrotask(()=>{t(o,i),i=o}),n=!1});return()=>W(r)}var Lt=[],Ft=[],Vt=[];function si(e){Vt.push(e)}function Je(e,t){typeof t=="function"?(e._x_cleanups||(e._x_cleanups=[]),e._x_cleanups.push(t)):(t=e,Ft.push(t))}function jt(e){Lt.push(e)}function Ut(e,t,n){e._x_attributeCleanups||(e._x_attributeCleanups={}),e._x_attributeCleanups[t]||(e._x_attributeCleanups[t]=[]),e._x_attributeCleanups[t].push(n)}function Kt(e,t){e._x_attributeCleanups&&Object.entries(e._x_attributeCleanups).forEach(([n,i])=>{(t===void 0||t.includes(n))&&(i.forEach(r=>r()),delete e._x_attributeCleanups[n])})}function ai(e){for(e._x_effects?.forEach(ei);e._x_cleanups?.length;)e._x_cleanups.pop()()}var Qe=new MutationObserver(Ze),Ge=!1;function Ye(){Qe.observe(document,{subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0}),Ge=!0}function Bt(){ci(),Qe.disconnect(),Ge=!1}var G=[];function ci(){let e=Qe.takeRecords();G.push(()=>e.length>0&&Ze(e));let t=G.length;queueMicrotask(()=>{if(G.length===t)for(;G.length>0;)G.shift()()})}function _(e){if(!Ge)return e();Bt();let t=e();return Ye(),t}var Xe=!1,ge=[];function li(){Xe=!0}function ui(){Xe=!1,Ze(ge),ge=[]}function Ze(e){if(Xe){ge=ge.concat(e);return}let t=[],n=new Set,i=new Map,r=new Map;for(let o=0;o<e.length;o++)if(!e[o].target._x_ignoreMutationObserver&&(e[o].type==="childList"&&(e[o].removedNodes.forEach(s=>{s.nodeType===1&&s._x_marker&&n.add(s)}),e[o].addedNodes.forEach(s=>{if(s.nodeType===1){if(n.has(s)){n.delete(s);return}s._x_marker||t.push(s)}})),e[o].type==="attributes")){let s=e[o].target,a=e[o].attributeName,c=e[o].oldValue,l=()=>{i.has(s)||i.set(s,[]),i.get(s).push({name:a,value:s.getAttribute(a)})},u=()=>{r.has(s)||r.set(s,[]),r.get(s).push(a)};s.hasAttribute(a)&&c===null?l():s.hasAttribute(a)?(u(),l()):u()}r.forEach((o,s)=>{Kt(s,o)}),i.forEach((o,s)=>{Lt.forEach(a=>a(s,o))});for(let o of n)t.some(s=>s.contains(o))||Ft.forEach(s=>s(o));for(let o of t)o.isConnected&&Vt.forEach(s=>s(o));t=null,n=null,i=null,r=null}function zt(e){return re(K(e))}function ie(e,t,n){return e._x_dataStack=[t,...K(n||e)],()=>{e._x_dataStack=e._x_dataStack.filter(i=>i!==t)}}function K(e){return e._x_dataStack?e._x_dataStack:typeof ShadowRoot=="function"&&e instanceof ShadowRoot?K(e.host):e.parentNode?K(e.parentNode):[]}function re(e){return new Proxy({objects:e},di)}var di={ownKeys({objects:e}){return Array.from(new Set(e.flatMap(t=>Object.keys(t))))},has({objects:e},t){return t==Symbol.unscopables?!1:e.some(n=>Object.prototype.hasOwnProperty.call(n,t)||Reflect.has(n,t))},get({objects:e},t,n){return t=="toJSON"?fi:Reflect.get(e.find(i=>Reflect.has(i,t))||{},t,n)},set({objects:e},t,n,i){const r=e.find(s=>Object.prototype.hasOwnProperty.call(s,t))||e[e.length-1],o=Object.getOwnPropertyDescriptor(r,t);return o?.set&&o?.get?o.set.call(i,n)||!0:Reflect.set(r,t,n)}};function fi(){return Reflect.ownKeys(this).reduce((t,n)=>(t[n]=Reflect.get(this,n),t),{})}function Wt(e){let t=i=>typeof i=="object"&&!Array.isArray(i)&&i!==null,n=(i,r="")=>{Object.entries(Object.getOwnPropertyDescriptors(i)).forEach(([o,{value:s,enumerable:a}])=>{if(a===!1||s===void 0||typeof s=="object"&&s!==null&&s.__v_skip)return;let c=r===""?o:`${r}.${o}`;typeof s=="object"&&s!==null&&s._x_interceptor?i[o]=s.initialize(e,c,o):t(s)&&s!==i&&!(s instanceof Element)&&n(s,c)})};return n(e)}function qt(e,t=()=>{}){let n={initialValue:void 0,_x_interceptor:!0,initialize(i,r,o){return e(this.initialValue,()=>hi(i,r),s=>Ne(i,r,s),r,o)}};return t(n),i=>{if(typeof i=="object"&&i!==null&&i._x_interceptor){let r=n.initialize.bind(n);n.initialize=(o,s,a)=>{let c=i.initialize(o,s,a);return n.initialValue=c,r(o,s,a)}}else n.initialValue=i;return n}}function hi(e,t){return t.split(".").reduce((n,i)=>n[i],e)}function Ne(e,t,n){if(typeof t=="string"&&(t=t.split(".")),t.length===1)e[t[0]]=n;else{if(t.length===0)throw error;return e[t[0]]||(e[t[0]]={}),Ne(e[t[0]],t.slice(1),n)}}var Ht={};function E(e,t){Ht[e]=t}function De(e,t){let n=pi(t);return Object.entries(Ht).forEach(([i,r])=>{Object.defineProperty(e,`$${i}`,{get(){return r(t,n)},enumerable:!1})}),e}function pi(e){let[t,n]=Zt(e),i={interceptor:qt,...t};return Je(e,n),i}function gi(e,t,n,...i){try{return n(...i)}catch(r){ne(r,e,t)}}function ne(e,t,n=void 0){e=Object.assign(e??{message:"No error message given."},{el:t,expression:n}),console.warn(`Alpine Expression Error: ${e.message}

${n?'Expression: "'+n+`"

`:""}`,t),setTimeout(()=>{throw e},0)}var he=!0;function Jt(e){let t=he;he=!1;let n=e();return he=t,n}function D(e,t,n={}){let i;return x(e,t)(r=>i=r,n),i}function x(...e){return Qt(...e)}var Qt=Gt;function mi(e){Qt=e}function Gt(e,t){let n={};De(n,e);let i=[n,...K(e)],r=typeof t=="function"?_i(i,t):vi(i,t,e);return gi.bind(null,e,t,r)}function _i(e,t){return(n=()=>{},{scope:i={},params:r=[]}={})=>{let o=t.apply(re([i,...e]),r);me(n,o)}}var Ee={};function yi(e,t){if(Ee[e])return Ee[e];let n=Object.getPrototypeOf(async function(){}).constructor,i=/^[\n\s]*if.*\(.*\)/.test(e.trim())||/^(let|const)\s/.test(e.trim())?`(async()=>{ ${e} })()`:e,o=(()=>{try{let s=new n(["__self","scope"],`with (scope) { __self.result = ${i} }; __self.finished = true; return __self.result;`);return Object.defineProperty(s,"name",{value:`[Alpine] ${e}`}),s}catch(s){return ne(s,t,e),Promise.resolve()}})();return Ee[e]=o,o}function vi(e,t,n){let i=yi(t,n);return(r=()=>{},{scope:o={},params:s=[]}={})=>{i.result=void 0,i.finished=!1;let a=re([o,...e]);if(typeof i=="function"){let c=i(i,a).catch(l=>ne(l,n,t));i.finished?(me(r,i.result,a,s,n),i.result=void 0):c.then(l=>{me(r,l,a,s,n)}).catch(l=>ne(l,n,t)).finally(()=>i.result=void 0)}}}function me(e,t,n,i,r){if(he&&typeof t=="function"){let o=t.apply(n,i);o instanceof Promise?o.then(s=>me(e,s,n,i)).catch(s=>ne(s,r,t)):e(o)}else typeof t=="object"&&t instanceof Promise?t.then(o=>e(o)):e(t)}var et="x-";function q(e=""){return et+e}function wi(e){et=e}var _e={};function w(e,t){return _e[e]=t,{before(n){if(!_e[n]){console.warn(String.raw`Cannot find directive \`${n}\`. \`${e}\` will use the default order of execution`);return}const i=$.indexOf(n);$.splice(i>=0?i:$.indexOf("DEFAULT"),0,e)}}}function bi(e){return Object.keys(_e).includes(e)}function tt(e,t,n){if(t=Array.from(t),e._x_virtualDirectives){let o=Object.entries(e._x_virtualDirectives).map(([a,c])=>({name:a,value:c})),s=Yt(o);o=o.map(a=>s.find(c=>c.name===a.name)?{name:`x-bind:${a.name}`,value:`"${a.value}"`}:a),t=t.concat(o)}let i={};return t.map(nn((o,s)=>i[o]=s)).filter(on).map(Mi(i,n)).sort(Ai).map(o=>Si(e,o))}function Yt(e){return Array.from(e).map(nn()).filter(t=>!on(t))}var Le=!1,Z=new Map,Xt=Symbol();function xi(e){Le=!0;let t=Symbol();Xt=t,Z.set(t,[]);let n=()=>{for(;Z.get(t).length;)Z.get(t).shift()();Z.delete(t)},i=()=>{Le=!1,n()};e(n),i()}function Zt(e){let t=[],n=a=>t.push(a),[i,r]=oi(e);return t.push(r),[{Alpine:oe,effect:i,cleanup:n,evaluateLater:x.bind(x,e),evaluate:D.bind(D,e)},()=>t.forEach(a=>a())]}function Si(e,t){let n=()=>{},i=_e[t.type]||n,[r,o]=Zt(e);Ut(e,t.original,o);let s=()=>{e._x_ignore||e._x_ignoreSelf||(i.inline&&i.inline(e,t,r),i=i.bind(i,e,t,r),Le?Z.get(Xt).push(i):i())};return s.runCleanups=o,s}var en=(e,t)=>({name:n,value:i})=>(n.startsWith(e)&&(n=n.replace(e,t)),{name:n,value:i}),tn=e=>e;function nn(e=()=>{}){return({name:t,value:n})=>{let{name:i,value:r}=rn.reduce((o,s)=>s(o),{name:t,value:n});return i!==t&&e(i,t),{name:i,value:r}}}var rn=[];function nt(e){rn.push(e)}function on({name:e}){return sn().test(e)}var sn=()=>new RegExp(`^${et}([^:^.]+)\\b`);function Mi(e,t){return({name:n,value:i})=>{let r=n.match(sn()),o=n.match(/:([a-zA-Z0-9\-_:]+)/),s=n.match(/\.[^.\]]+(?=[^\]]*$)/g)||[],a=t||e[n]||n;return{type:r?r[1]:null,value:o?o[1]:null,modifiers:s.map(c=>c.replace(".","")),expression:i,original:a}}}var Fe="DEFAULT",$=["ignore","ref","data","id","anchor","bind","init","for","model","modelable","transition","show","if",Fe,"teleport"];function Ai(e,t){let n=$.indexOf(e.type)===-1?Fe:e.type,i=$.indexOf(t.type)===-1?Fe:t.type;return $.indexOf(n)-$.indexOf(i)}function ee(e,t,n={}){e.dispatchEvent(new CustomEvent(t,{detail:n,bubbles:!0,composed:!0,cancelable:!0}))}function V(e,t){if(typeof ShadowRoot=="function"&&e instanceof ShadowRoot){Array.from(e.children).forEach(r=>V(r,t));return}let n=!1;if(t(e,()=>n=!0),n)return;let i=e.firstElementChild;for(;i;)V(i,t),i=i.nextElementSibling}function M(e,...t){console.warn(`Alpine Warning: ${e}`,...t)}var vt=!1;function Ei(){vt&&M("Alpine has already been initialized on this page. Calling Alpine.start() more than once can cause problems."),vt=!0,document.body||M("Unable to initialize. Trying to load Alpine before `<body>` is available. Did you forget to add `defer` in Alpine's `<script>` tag?"),ee(document,"alpine:init"),ee(document,"alpine:initializing"),Ye(),si(t=>P(t,V)),Je(t=>J(t)),jt((t,n)=>{tt(t,n).forEach(i=>i())});let e=t=>!ve(t.parentElement,!0);Array.from(document.querySelectorAll(ln().join(","))).filter(e).forEach(t=>{P(t)}),ee(document,"alpine:initialized"),setTimeout(()=>{Ri()})}var it=[],an=[];function cn(){return it.map(e=>e())}function ln(){return it.concat(an).map(e=>e())}function un(e){it.push(e)}function dn(e){an.push(e)}function ve(e,t=!1){return H(e,n=>{if((t?ln():cn()).some(r=>n.matches(r)))return!0})}function H(e,t){if(e){if(t(e))return e;if(e._x_teleportBack&&(e=e._x_teleportBack),!!e.parentElement)return H(e.parentElement,t)}}function Ci(e){return cn().some(t=>e.matches(t))}var fn=[];function Pi(e){fn.push(e)}var Ii=1;function P(e,t=V,n=()=>{}){H(e,i=>i._x_ignore)||xi(()=>{t(e,(i,r)=>{i._x_marker||(n(i,r),fn.forEach(o=>o(i,r)),tt(i,i.attributes).forEach(o=>o()),i._x_ignore||(i._x_marker=Ii++),i._x_ignore&&r())})})}function J(e,t=V){t(e,n=>{ai(n),Kt(n),delete n._x_marker})}function Ri(){[["ui","dialog",["[x-dialog], [x-popover]"]],["anchor","anchor",["[x-anchor]"]],["sort","sort",["[x-sort]"]]].forEach(([t,n,i])=>{bi(n)||i.some(r=>{if(document.querySelector(r))return M(`found "${r}", but missing ${t} plugin`),!0})})}var Ve=[],rt=!1;function ot(e=()=>{}){return queueMicrotask(()=>{rt||setTimeout(()=>{je()})}),new Promise(t=>{Ve.push(()=>{e(),t()})})}function je(){for(rt=!1;Ve.length;)Ve.shift()()}function Ti(){rt=!0}function st(e,t){return Array.isArray(t)?wt(e,t.join(" ")):typeof t=="object"&&t!==null?Oi(e,t):typeof t=="function"?st(e,t()):wt(e,t)}function wt(e,t){let n=r=>r.split(" ").filter(o=>!e.classList.contains(o)).filter(Boolean),i=r=>(e.classList.add(...r),()=>{e.classList.remove(...r)});return t=t===!0?t="":t||"",i(n(t))}function Oi(e,t){let n=a=>a.split(" ").filter(Boolean),i=Object.entries(t).flatMap(([a,c])=>c?n(a):!1).filter(Boolean),r=Object.entries(t).flatMap(([a,c])=>c?!1:n(a)).filter(Boolean),o=[],s=[];return r.forEach(a=>{e.classList.contains(a)&&(e.classList.remove(a),s.push(a))}),i.forEach(a=>{e.classList.contains(a)||(e.classList.add(a),o.push(a))}),()=>{s.forEach(a=>e.classList.add(a)),o.forEach(a=>e.classList.remove(a))}}function we(e,t){return typeof t=="object"&&t!==null?ki(e,t):$i(e,t)}function ki(e,t){let n={};return Object.entries(t).forEach(([i,r])=>{n[i]=e.style[i],i.startsWith("--")||(i=Ni(i)),e.style.setProperty(i,r)}),setTimeout(()=>{e.style.length===0&&e.removeAttribute("style")}),()=>{we(e,n)}}function $i(e,t){let n=e.getAttribute("style",t);return e.setAttribute("style",t),()=>{e.setAttribute("style",n||"")}}function Ni(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function Ue(e,t=()=>{}){let n=!1;return function(){n?t.apply(this,arguments):(n=!0,e.apply(this,arguments))}}w("transition",(e,{value:t,modifiers:n,expression:i},{evaluate:r})=>{typeof i=="function"&&(i=r(i)),i!==!1&&(!i||typeof i=="boolean"?Li(e,n,t):Di(e,i,t))});function Di(e,t,n){hn(e,st,""),{enter:r=>{e._x_transition.enter.during=r},"enter-start":r=>{e._x_transition.enter.start=r},"enter-end":r=>{e._x_transition.enter.end=r},leave:r=>{e._x_transition.leave.during=r},"leave-start":r=>{e._x_transition.leave.start=r},"leave-end":r=>{e._x_transition.leave.end=r}}[n](t)}function Li(e,t,n){hn(e,we);let i=!t.includes("in")&&!t.includes("out")&&!n,r=i||t.includes("in")||["enter"].includes(n),o=i||t.includes("out")||["leave"].includes(n);t.includes("in")&&!i&&(t=t.filter((m,y)=>y<t.indexOf("out"))),t.includes("out")&&!i&&(t=t.filter((m,y)=>y>t.indexOf("out")));let s=!t.includes("opacity")&&!t.includes("scale"),a=s||t.includes("opacity"),c=s||t.includes("scale"),l=a?0:1,u=c?Y(t,"scale",95)/100:1,d=Y(t,"delay",0)/1e3,h=Y(t,"origin","center"),p="opacity, transform",v=Y(t,"duration",150)/1e3,se=Y(t,"duration",75)/1e3,f="cubic-bezier(0.4, 0.0, 0.2, 1)";r&&(e._x_transition.enter.during={transformOrigin:h,transitionDelay:`${d}s`,transitionProperty:p,transitionDuration:`${v}s`,transitionTimingFunction:f},e._x_transition.enter.start={opacity:l,transform:`scale(${u})`},e._x_transition.enter.end={opacity:1,transform:"scale(1)"}),o&&(e._x_transition.leave.during={transformOrigin:h,transitionDelay:`${d}s`,transitionProperty:p,transitionDuration:`${se}s`,transitionTimingFunction:f},e._x_transition.leave.start={opacity:1,transform:"scale(1)"},e._x_transition.leave.end={opacity:l,transform:`scale(${u})`})}function hn(e,t,n={}){e._x_transition||(e._x_transition={enter:{during:n,start:n,end:n},leave:{during:n,start:n,end:n},in(i=()=>{},r=()=>{}){Ke(e,t,{during:this.enter.during,start:this.enter.start,end:this.enter.end},i,r)},out(i=()=>{},r=()=>{}){Ke(e,t,{during:this.leave.during,start:this.leave.start,end:this.leave.end},i,r)}})}window.Element.prototype._x_toggleAndCascadeWithTransitions=function(e,t,n,i){const r=document.visibilityState==="visible"?requestAnimationFrame:setTimeout;let o=()=>r(n);if(t){e._x_transition&&(e._x_transition.enter||e._x_transition.leave)?e._x_transition.enter&&(Object.entries(e._x_transition.enter.during).length||Object.entries(e._x_transition.enter.start).length||Object.entries(e._x_transition.enter.end).length)?e._x_transition.in(n):o():e._x_transition?e._x_transition.in(n):o();return}e._x_hidePromise=e._x_transition?new Promise((s,a)=>{e._x_transition.out(()=>{},()=>s(i)),e._x_transitioning&&e._x_transitioning.beforeCancel(()=>a({isFromCancelledTransition:!0}))}):Promise.resolve(i),queueMicrotask(()=>{let s=pn(e);s?(s._x_hideChildren||(s._x_hideChildren=[]),s._x_hideChildren.push(e)):r(()=>{let a=c=>{let l=Promise.all([c._x_hidePromise,...(c._x_hideChildren||[]).map(a)]).then(([u])=>u?.());return delete c._x_hidePromise,delete c._x_hideChildren,l};a(e).catch(c=>{if(!c.isFromCancelledTransition)throw c})})})};function pn(e){let t=e.parentNode;if(t)return t._x_hidePromise?t:pn(t)}function Ke(e,t,{during:n,start:i,end:r}={},o=()=>{},s=()=>{}){if(e._x_transitioning&&e._x_transitioning.cancel(),Object.keys(n).length===0&&Object.keys(i).length===0&&Object.keys(r).length===0){o(),s();return}let a,c,l;Fi(e,{start(){a=t(e,i)},during(){c=t(e,n)},before:o,end(){a(),l=t(e,r)},after:s,cleanup(){c(),l()}})}function Fi(e,t){let n,i,r,o=Ue(()=>{_(()=>{n=!0,i||t.before(),r||(t.end(),je()),t.after(),e.isConnected&&t.cleanup(),delete e._x_transitioning})});e._x_transitioning={beforeCancels:[],beforeCancel(s){this.beforeCancels.push(s)},cancel:Ue(function(){for(;this.beforeCancels.length;)this.beforeCancels.shift()();o()}),finish:o},_(()=>{t.start(),t.during()}),Ti(),requestAnimationFrame(()=>{if(n)return;let s=Number(getComputedStyle(e).transitionDuration.replace(/,.*/,"").replace("s",""))*1e3,a=Number(getComputedStyle(e).transitionDelay.replace(/,.*/,"").replace("s",""))*1e3;s===0&&(s=Number(getComputedStyle(e).animationDuration.replace("s",""))*1e3),_(()=>{t.before()}),i=!0,requestAnimationFrame(()=>{n||(_(()=>{t.end()}),je(),setTimeout(e._x_transitioning.finish,s+a),r=!0)})})}function Y(e,t,n){if(e.indexOf(t)===-1)return n;const i=e[e.indexOf(t)+1];if(!i||t==="scale"&&isNaN(i))return n;if(t==="duration"||t==="delay"){let r=i.match(/([0-9]+)ms/);if(r)return r[1]}return t==="origin"&&["top","right","left","center","bottom"].includes(e[e.indexOf(t)+2])?[i,e[e.indexOf(t)+2]].join(" "):i}var R=!1;function O(e,t=()=>{}){return(...n)=>R?t(...n):e(...n)}function Vi(e){return(...t)=>R&&e(...t)}var gn=[];function be(e){gn.push(e)}function ji(e,t){gn.forEach(n=>n(e,t)),R=!0,mn(()=>{P(t,(n,i)=>{i(n,()=>{})})}),R=!1}var Be=!1;function Ui(e,t){t._x_dataStack||(t._x_dataStack=e._x_dataStack),R=!0,Be=!0,mn(()=>{Ki(t)}),R=!1,Be=!1}function Ki(e){let t=!1;P(e,(i,r)=>{V(i,(o,s)=>{if(t&&Ci(o))return s();t=!0,r(o,s)})})}function mn(e){let t=j;yt((n,i)=>{let r=t(n);return W(r),()=>{}}),e(),yt(t)}function _n(e,t,n,i=[]){switch(e._x_bindings||(e._x_bindings=z({})),e._x_bindings[t]=n,t=i.includes("camel")?Gi(t):t,t){case"value":Bi(e,n);break;case"style":Wi(e,n);break;case"class":zi(e,n);break;case"selected":case"checked":qi(e,t,n);break;default:yn(e,t,n);break}}function Bi(e,t){if(bn(e))e.attributes.value===void 0&&(e.value=t),window.fromModel&&(typeof t=="boolean"?e.checked=pe(e.value)===t:e.checked=bt(e.value,t));else if(at(e))Number.isInteger(t)?e.value=t:!Array.isArray(t)&&typeof t!="boolean"&&![null,void 0].includes(t)?e.value=String(t):Array.isArray(t)?e.checked=t.some(n=>bt(n,e.value)):e.checked=!!t;else if(e.tagName==="SELECT")Qi(e,t);else{if(e.value===t)return;e.value=t===void 0?"":t}}function zi(e,t){e._x_undoAddedClasses&&e._x_undoAddedClasses(),e._x_undoAddedClasses=st(e,t)}function Wi(e,t){e._x_undoAddedStyles&&e._x_undoAddedStyles(),e._x_undoAddedStyles=we(e,t)}function qi(e,t,n){yn(e,t,n),Ji(e,t,n)}function yn(e,t,n){[null,void 0,!1].includes(n)&&Xi(t)?e.removeAttribute(t):(vn(t)&&(n=t),Hi(e,t,n))}function Hi(e,t,n){e.getAttribute(t)!=n&&e.setAttribute(t,n)}function Ji(e,t,n){e[t]!==n&&(e[t]=n)}function Qi(e,t){const n=[].concat(t).map(i=>i+"");Array.from(e.options).forEach(i=>{i.selected=n.includes(i.value)})}function Gi(e){return e.toLowerCase().replace(/-(\w)/g,(t,n)=>n.toUpperCase())}function bt(e,t){return e==t}function pe(e){return[1,"1","true","on","yes",!0].includes(e)?!0:[0,"0","false","off","no",!1].includes(e)?!1:e?!!e:null}var Yi=new Set(["allowfullscreen","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","inert","ismap","itemscope","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected","shadowrootclonable","shadowrootdelegatesfocus","shadowrootserializable"]);function vn(e){return Yi.has(e)}function Xi(e){return!["aria-pressed","aria-checked","aria-expanded","aria-selected"].includes(e)}function Zi(e,t,n){return e._x_bindings&&e._x_bindings[t]!==void 0?e._x_bindings[t]:wn(e,t,n)}function er(e,t,n,i=!0){if(e._x_bindings&&e._x_bindings[t]!==void 0)return e._x_bindings[t];if(e._x_inlineBindings&&e._x_inlineBindings[t]!==void 0){let r=e._x_inlineBindings[t];return r.extract=i,Jt(()=>D(e,r.expression))}return wn(e,t,n)}function wn(e,t,n){let i=e.getAttribute(t);return i===null?typeof n=="function"?n():n:i===""?!0:vn(t)?!![t,"true"].includes(i):i}function at(e){return e.type==="checkbox"||e.localName==="ui-checkbox"||e.localName==="ui-switch"}function bn(e){return e.type==="radio"||e.localName==="ui-radio"}function xn(e,t){var n;return function(){var i=this,r=arguments,o=function(){n=null,e.apply(i,r)};clearTimeout(n),n=setTimeout(o,t)}}function Sn(e,t){let n;return function(){let i=this,r=arguments;n||(e.apply(i,r),n=!0,setTimeout(()=>n=!1,t))}}function Mn({get:e,set:t},{get:n,set:i}){let r=!0,o,s=j(()=>{let a=e(),c=n();if(r)i(Ce(a)),r=!1;else{let l=JSON.stringify(a),u=JSON.stringify(c);l!==o?i(Ce(a)):l!==u&&t(Ce(c))}o=JSON.stringify(e()),JSON.stringify(n())});return()=>{W(s)}}function Ce(e){return typeof e=="object"?JSON.parse(JSON.stringify(e)):e}function tr(e){(Array.isArray(e)?e:[e]).forEach(n=>n(oe))}var k={},xt=!1;function nr(e,t){if(xt||(k=z(k),xt=!0),t===void 0)return k[e];k[e]=t,Wt(k[e]),typeof t=="object"&&t!==null&&t.hasOwnProperty("init")&&typeof t.init=="function"&&k[e].init()}function ir(){return k}var An={};function rr(e,t){let n=typeof t!="function"?()=>t:t;return e instanceof Element?En(e,n()):(An[e]=n,()=>{})}function or(e){return Object.entries(An).forEach(([t,n])=>{Object.defineProperty(e,t,{get(){return(...i)=>n(...i)}})}),e}function En(e,t,n){let i=[];for(;i.length;)i.pop()();let r=Object.entries(t).map(([s,a])=>({name:s,value:a})),o=Yt(r);return r=r.map(s=>o.find(a=>a.name===s.name)?{name:`x-bind:${s.name}`,value:`"${s.value}"`}:s),tt(e,r,n).map(s=>{i.push(s.runCleanups),s()}),()=>{for(;i.length;)i.pop()()}}var Cn={};function sr(e,t){Cn[e]=t}function ar(e,t){return Object.entries(Cn).forEach(([n,i])=>{Object.defineProperty(e,n,{get(){return(...r)=>i.bind(t)(...r)},enumerable:!1})}),e}var cr={get reactive(){return z},get release(){return W},get effect(){return j},get raw(){return Nt},version:"3.14.9",flushAndStopDeferringMutations:ui,dontAutoEvaluateFunctions:Jt,disableEffectScheduling:ii,startObservingMutations:Ye,stopObservingMutations:Bt,setReactivityEngine:ri,onAttributeRemoved:Ut,onAttributesAdded:jt,closestDataStack:K,skipDuringClone:O,onlyDuringClone:Vi,addRootSelector:un,addInitSelector:dn,interceptClone:be,addScopeToNode:ie,deferMutations:li,mapAttributes:nt,evaluateLater:x,interceptInit:Pi,setEvaluator:mi,mergeProxies:re,extractProp:er,findClosest:H,onElRemoved:Je,closestRoot:ve,destroyTree:J,interceptor:qt,transition:Ke,setStyles:we,mutateDom:_,directive:w,entangle:Mn,throttle:Sn,debounce:xn,evaluate:D,initTree:P,nextTick:ot,prefixed:q,prefix:wi,plugin:tr,magic:E,store:nr,start:Ei,clone:Ui,cloneNode:ji,bound:Zi,$data:zt,watch:Dt,walk:V,data:sr,bind:rr},oe=cr;function lr(e,t){const n=Object.create(null),i=e.split(",");for(let r=0;r<i.length;r++)n[i[r]]=!0;return r=>!!n[r]}var ur=Object.freeze({}),dr=Object.prototype.hasOwnProperty,xe=(e,t)=>dr.call(e,t),L=Array.isArray,te=e=>Pn(e)==="[object Map]",fr=e=>typeof e=="string",ct=e=>typeof e=="symbol",Se=e=>e!==null&&typeof e=="object",hr=Object.prototype.toString,Pn=e=>hr.call(e),In=e=>Pn(e).slice(8,-1),lt=e=>fr(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,pr=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},gr=pr(e=>e.charAt(0).toUpperCase()+e.slice(1)),Rn=(e,t)=>e!==t&&(e===e||t===t),ze=new WeakMap,X=[],C,F=Symbol("iterate"),We=Symbol("Map key iterate");function mr(e){return e&&e._isEffect===!0}function _r(e,t=ur){mr(e)&&(e=e.raw);const n=wr(e,t);return t.lazy||n(),n}function yr(e){e.active&&(Tn(e),e.options.onStop&&e.options.onStop(),e.active=!1)}var vr=0;function wr(e,t){const n=function(){if(!n.active)return e();if(!X.includes(n)){Tn(n);try{return xr(),X.push(n),C=n,e()}finally{X.pop(),On(),C=X[X.length-1]}}};return n.id=vr++,n.allowRecurse=!!t.allowRecurse,n._isEffect=!0,n.active=!0,n.raw=e,n.deps=[],n.options=t,n}function Tn(e){const{deps:t}=e;if(t.length){for(let n=0;n<t.length;n++)t[n].delete(e);t.length=0}}var B=!0,ut=[];function br(){ut.push(B),B=!1}function xr(){ut.push(B),B=!0}function On(){const e=ut.pop();B=e===void 0?!0:e}function A(e,t,n){if(!B||C===void 0)return;let i=ze.get(e);i||ze.set(e,i=new Map);let r=i.get(n);r||i.set(n,r=new Set),r.has(C)||(r.add(C),C.deps.push(r),C.options.onTrack&&C.options.onTrack({effect:C,target:e,type:t,key:n}))}function T(e,t,n,i,r,o){const s=ze.get(e);if(!s)return;const a=new Set,c=u=>{u&&u.forEach(d=>{(d!==C||d.allowRecurse)&&a.add(d)})};if(t==="clear")s.forEach(c);else if(n==="length"&&L(e))s.forEach((u,d)=>{(d==="length"||d>=i)&&c(u)});else switch(n!==void 0&&c(s.get(n)),t){case"add":L(e)?lt(n)&&c(s.get("length")):(c(s.get(F)),te(e)&&c(s.get(We)));break;case"delete":L(e)||(c(s.get(F)),te(e)&&c(s.get(We)));break;case"set":te(e)&&c(s.get(F));break}const l=u=>{u.options.onTrigger&&u.options.onTrigger({effect:u,target:e,key:n,type:t,newValue:i,oldValue:r,oldTarget:o}),u.options.scheduler?u.options.scheduler(u):u()};a.forEach(l)}var Sr=lr("__proto__,__v_isRef,__isVue"),kn=new Set(Object.getOwnPropertyNames(Symbol).map(e=>Symbol[e]).filter(ct)),Mr=$n(),Ar=$n(!0),St=Er();function Er(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...n){const i=g(this);for(let o=0,s=this.length;o<s;o++)A(i,"get",o+"");const r=i[t](...n);return r===-1||r===!1?i[t](...n.map(g)):r}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...n){br();const i=g(this)[t].apply(this,n);return On(),i}}),e}function $n(e=!1,t=!1){return function(i,r,o){if(r==="__v_isReactive")return!e;if(r==="__v_isReadonly")return e;if(r==="__v_raw"&&o===(e?t?jr:Fn:t?Vr:Ln).get(i))return i;const s=L(i);if(!e&&s&&xe(St,r))return Reflect.get(St,r,o);const a=Reflect.get(i,r,o);return(ct(r)?kn.has(r):Sr(r))||(e||A(i,"get",r),t)?a:qe(a)?!s||!lt(r)?a.value:a:Se(a)?e?Vn(a):pt(a):a}}var Cr=Pr();function Pr(e=!1){return function(n,i,r,o){let s=n[i];if(!e&&(r=g(r),s=g(s),!L(n)&&qe(s)&&!qe(r)))return s.value=r,!0;const a=L(n)&&lt(i)?Number(i)<n.length:xe(n,i),c=Reflect.set(n,i,r,o);return n===g(o)&&(a?Rn(r,s)&&T(n,"set",i,r,s):T(n,"add",i,r)),c}}function Ir(e,t){const n=xe(e,t),i=e[t],r=Reflect.deleteProperty(e,t);return r&&n&&T(e,"delete",t,void 0,i),r}function Rr(e,t){const n=Reflect.has(e,t);return(!ct(t)||!kn.has(t))&&A(e,"has",t),n}function Tr(e){return A(e,"iterate",L(e)?"length":F),Reflect.ownKeys(e)}var Or={get:Mr,set:Cr,deleteProperty:Ir,has:Rr,ownKeys:Tr},kr={get:Ar,set(e,t){return console.warn(`Set operation on key "${String(t)}" failed: target is readonly.`,e),!0},deleteProperty(e,t){return console.warn(`Delete operation on key "${String(t)}" failed: target is readonly.`,e),!0}},dt=e=>Se(e)?pt(e):e,ft=e=>Se(e)?Vn(e):e,ht=e=>e,Me=e=>Reflect.getPrototypeOf(e);function ce(e,t,n=!1,i=!1){e=e.__v_raw;const r=g(e),o=g(t);t!==o&&!n&&A(r,"get",t),!n&&A(r,"get",o);const{has:s}=Me(r),a=i?ht:n?ft:dt;if(s.call(r,t))return a(e.get(t));if(s.call(r,o))return a(e.get(o));e!==r&&e.get(t)}function le(e,t=!1){const n=this.__v_raw,i=g(n),r=g(e);return e!==r&&!t&&A(i,"has",e),!t&&A(i,"has",r),e===r?n.has(e):n.has(e)||n.has(r)}function ue(e,t=!1){return e=e.__v_raw,!t&&A(g(e),"iterate",F),Reflect.get(e,"size",e)}function Mt(e){e=g(e);const t=g(this);return Me(t).has.call(t,e)||(t.add(e),T(t,"add",e,e)),this}function At(e,t){t=g(t);const n=g(this),{has:i,get:r}=Me(n);let o=i.call(n,e);o?Dn(n,i,e):(e=g(e),o=i.call(n,e));const s=r.call(n,e);return n.set(e,t),o?Rn(t,s)&&T(n,"set",e,t,s):T(n,"add",e,t),this}function Et(e){const t=g(this),{has:n,get:i}=Me(t);let r=n.call(t,e);r?Dn(t,n,e):(e=g(e),r=n.call(t,e));const o=i?i.call(t,e):void 0,s=t.delete(e);return r&&T(t,"delete",e,void 0,o),s}function Ct(){const e=g(this),t=e.size!==0,n=te(e)?new Map(e):new Set(e),i=e.clear();return t&&T(e,"clear",void 0,void 0,n),i}function de(e,t){return function(i,r){const o=this,s=o.__v_raw,a=g(s),c=t?ht:e?ft:dt;return!e&&A(a,"iterate",F),s.forEach((l,u)=>i.call(r,c(l),c(u),o))}}function fe(e,t,n){return function(...i){const r=this.__v_raw,o=g(r),s=te(o),a=e==="entries"||e===Symbol.iterator&&s,c=e==="keys"&&s,l=r[e](...i),u=n?ht:t?ft:dt;return!t&&A(o,"iterate",c?We:F),{next(){const{value:d,done:h}=l.next();return h?{value:d,done:h}:{value:a?[u(d[0]),u(d[1])]:u(d),done:h}},[Symbol.iterator](){return this}}}}function I(e){return function(...t){{const n=t[0]?`on key "${t[0]}" `:"";console.warn(`${gr(e)} operation ${n}failed: target is readonly.`,g(this))}return e==="delete"?!1:this}}function $r(){const e={get(o){return ce(this,o)},get size(){return ue(this)},has:le,add:Mt,set:At,delete:Et,clear:Ct,forEach:de(!1,!1)},t={get(o){return ce(this,o,!1,!0)},get size(){return ue(this)},has:le,add:Mt,set:At,delete:Et,clear:Ct,forEach:de(!1,!0)},n={get(o){return ce(this,o,!0)},get size(){return ue(this,!0)},has(o){return le.call(this,o,!0)},add:I("add"),set:I("set"),delete:I("delete"),clear:I("clear"),forEach:de(!0,!1)},i={get(o){return ce(this,o,!0,!0)},get size(){return ue(this,!0)},has(o){return le.call(this,o,!0)},add:I("add"),set:I("set"),delete:I("delete"),clear:I("clear"),forEach:de(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(o=>{e[o]=fe(o,!1,!1),n[o]=fe(o,!0,!1),t[o]=fe(o,!1,!0),i[o]=fe(o,!0,!0)}),[e,n,t,i]}var[Nr,Dr,lo,uo]=$r();function Nn(e,t){const n=e?Dr:Nr;return(i,r,o)=>r==="__v_isReactive"?!e:r==="__v_isReadonly"?e:r==="__v_raw"?i:Reflect.get(xe(n,r)&&r in i?n:i,r,o)}var Lr={get:Nn(!1)},Fr={get:Nn(!0)};function Dn(e,t,n){const i=g(n);if(i!==n&&t.call(e,i)){const r=In(e);console.warn(`Reactive ${r} contains both the raw and reactive versions of the same object${r==="Map"?" as keys":""}, which can lead to inconsistencies. Avoid differentiating between the raw and reactive versions of an object and only use the reactive version if possible.`)}}var Ln=new WeakMap,Vr=new WeakMap,Fn=new WeakMap,jr=new WeakMap;function Ur(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Kr(e){return e.__v_skip||!Object.isExtensible(e)?0:Ur(In(e))}function pt(e){return e&&e.__v_isReadonly?e:jn(e,!1,Or,Lr,Ln)}function Vn(e){return jn(e,!0,kr,Fr,Fn)}function jn(e,t,n,i,r){if(!Se(e))return console.warn(`value cannot be made reactive: ${String(e)}`),e;if(e.__v_raw&&!(t&&e.__v_isReactive))return e;const o=r.get(e);if(o)return o;const s=Kr(e);if(s===0)return e;const a=new Proxy(e,s===2?i:n);return r.set(e,a),a}function g(e){return e&&g(e.__v_raw)||e}function qe(e){return!!(e&&e.__v_isRef===!0)}E("nextTick",()=>ot);E("dispatch",e=>ee.bind(ee,e));E("watch",(e,{evaluateLater:t,cleanup:n})=>(i,r)=>{let o=t(i),a=Dt(()=>{let c;return o(l=>c=l),c},r);n(a)});E("store",ir);E("data",e=>zt(e));E("root",e=>ve(e));E("refs",e=>(e._x_refs_proxy||(e._x_refs_proxy=re(Br(e))),e._x_refs_proxy));function Br(e){let t=[];return H(e,n=>{n._x_refs&&t.push(n._x_refs)}),t}var Pe={};function Un(e){return Pe[e]||(Pe[e]=0),++Pe[e]}function zr(e,t){return H(e,n=>{if(n._x_ids&&n._x_ids[t])return!0})}function Wr(e,t){e._x_ids||(e._x_ids={}),e._x_ids[t]||(e._x_ids[t]=Un(t))}E("id",(e,{cleanup:t})=>(n,i=null)=>{let r=`${n}${i?`-${i}`:""}`;return qr(e,r,t,()=>{let o=zr(e,n),s=o?o._x_ids[n]:Un(n);return i?`${n}-${s}-${i}`:`${n}-${s}`})});be((e,t)=>{e._x_id&&(t._x_id=e._x_id)});function qr(e,t,n,i){if(e._x_id||(e._x_id={}),e._x_id[t])return e._x_id[t];let r=i();return e._x_id[t]=r,n(()=>{delete e._x_id[t]}),r}E("el",e=>e);Kn("Focus","focus","focus");Kn("Persist","persist","persist");function Kn(e,t,n){E(t,i=>M(`You can't use [$${t}] without first installing the "${e}" plugin here: https://alpinejs.dev/plugins/${n}`,i))}w("modelable",(e,{expression:t},{effect:n,evaluateLater:i,cleanup:r})=>{let o=i(t),s=()=>{let u;return o(d=>u=d),u},a=i(`${t} = __placeholder`),c=u=>a(()=>{},{scope:{__placeholder:u}}),l=s();c(l),queueMicrotask(()=>{if(!e._x_model)return;e._x_removeModelListeners.default();let u=e._x_model.get,d=e._x_model.set,h=Mn({get(){return u()},set(p){d(p)}},{get(){return s()},set(p){c(p)}});r(h)})});w("teleport",(e,{modifiers:t,expression:n},{cleanup:i})=>{e.tagName.toLowerCase()!=="template"&&M("x-teleport can only be used on a <template> tag",e);let r=Pt(n),o=e.content.cloneNode(!0).firstElementChild;e._x_teleport=o,o._x_teleportBack=e,e.setAttribute("data-teleport-template",!0),o.setAttribute("data-teleport-target",!0),e._x_forwardEvents&&e._x_forwardEvents.forEach(a=>{o.addEventListener(a,c=>{c.stopPropagation(),e.dispatchEvent(new c.constructor(c.type,c))})}),ie(o,{},e);let s=(a,c,l)=>{l.includes("prepend")?c.parentNode.insertBefore(a,c):l.includes("append")?c.parentNode.insertBefore(a,c.nextSibling):c.appendChild(a)};_(()=>{s(o,r,t),O(()=>{P(o)})()}),e._x_teleportPutBack=()=>{let a=Pt(n);_(()=>{s(e._x_teleport,a,t)})},i(()=>_(()=>{o.remove(),J(o)}))});var Hr=document.createElement("div");function Pt(e){let t=O(()=>document.querySelector(e),()=>Hr)();return t||M(`Cannot find x-teleport element for selector: "${e}"`),t}var Bn=()=>{};Bn.inline=(e,{modifiers:t},{cleanup:n})=>{t.includes("self")?e._x_ignoreSelf=!0:e._x_ignore=!0,n(()=>{t.includes("self")?delete e._x_ignoreSelf:delete e._x_ignore})};w("ignore",Bn);w("effect",O((e,{expression:t},{effect:n})=>{n(x(e,t))}));function He(e,t,n,i){let r=e,o=c=>i(c),s={},a=(c,l)=>u=>l(c,u);if(n.includes("dot")&&(t=Jr(t)),n.includes("camel")&&(t=Qr(t)),n.includes("passive")&&(s.passive=!0),n.includes("capture")&&(s.capture=!0),n.includes("window")&&(r=window),n.includes("document")&&(r=document),n.includes("debounce")){let c=n[n.indexOf("debounce")+1]||"invalid-wait",l=ye(c.split("ms")[0])?Number(c.split("ms")[0]):250;o=xn(o,l)}if(n.includes("throttle")){let c=n[n.indexOf("throttle")+1]||"invalid-wait",l=ye(c.split("ms")[0])?Number(c.split("ms")[0]):250;o=Sn(o,l)}return n.includes("prevent")&&(o=a(o,(c,l)=>{l.preventDefault(),c(l)})),n.includes("stop")&&(o=a(o,(c,l)=>{l.stopPropagation(),c(l)})),n.includes("once")&&(o=a(o,(c,l)=>{c(l),r.removeEventListener(t,o,s)})),(n.includes("away")||n.includes("outside"))&&(r=document,o=a(o,(c,l)=>{e.contains(l.target)||l.target.isConnected!==!1&&(e.offsetWidth<1&&e.offsetHeight<1||e._x_isShown!==!1&&c(l))})),n.includes("self")&&(o=a(o,(c,l)=>{l.target===e&&c(l)})),(Yr(t)||zn(t))&&(o=a(o,(c,l)=>{Xr(l,n)||c(l)})),r.addEventListener(t,o,s),()=>{r.removeEventListener(t,o,s)}}function Jr(e){return e.replace(/-/g,".")}function Qr(e){return e.toLowerCase().replace(/-(\w)/g,(t,n)=>n.toUpperCase())}function ye(e){return!Array.isArray(e)&&!isNaN(e)}function Gr(e){return[" ","_"].includes(e)?e:e.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[_\s]/,"-").toLowerCase()}function Yr(e){return["keydown","keyup"].includes(e)}function zn(e){return["contextmenu","click","mouse"].some(t=>e.includes(t))}function Xr(e,t){let n=t.filter(o=>!["window","document","prevent","stop","once","capture","self","away","outside","passive"].includes(o));if(n.includes("debounce")){let o=n.indexOf("debounce");n.splice(o,ye((n[o+1]||"invalid-wait").split("ms")[0])?2:1)}if(n.includes("throttle")){let o=n.indexOf("throttle");n.splice(o,ye((n[o+1]||"invalid-wait").split("ms")[0])?2:1)}if(n.length===0||n.length===1&&It(e.key).includes(n[0]))return!1;const r=["ctrl","shift","alt","meta","cmd","super"].filter(o=>n.includes(o));return n=n.filter(o=>!r.includes(o)),!(r.length>0&&r.filter(s=>((s==="cmd"||s==="super")&&(s="meta"),e[`${s}Key`])).length===r.length&&(zn(e.type)||It(e.key).includes(n[0])))}function It(e){if(!e)return[];e=Gr(e);let t={ctrl:"control",slash:"/",space:" ",spacebar:" ",cmd:"meta",esc:"escape",up:"arrow-up",down:"arrow-down",left:"arrow-left",right:"arrow-right",period:".",comma:",",equal:"=",minus:"-",underscore:"_"};return t[e]=e,Object.keys(t).map(n=>{if(t[n]===e)return n}).filter(n=>n)}w("model",(e,{modifiers:t,expression:n},{effect:i,cleanup:r})=>{let o=e;t.includes("parent")&&(o=e.parentNode);let s=x(o,n),a;typeof n=="string"?a=x(o,`${n} = __placeholder`):typeof n=="function"&&typeof n()=="string"?a=x(o,`${n()} = __placeholder`):a=()=>{};let c=()=>{let h;return s(p=>h=p),Rt(h)?h.get():h},l=h=>{let p;s(v=>p=v),Rt(p)?p.set(h):a(()=>{},{scope:{__placeholder:h}})};typeof n=="string"&&e.type==="radio"&&_(()=>{e.hasAttribute("name")||e.setAttribute("name",n)});var u=e.tagName.toLowerCase()==="select"||["checkbox","radio"].includes(e.type)||t.includes("lazy")?"change":"input";let d=R?()=>{}:He(e,u,t,h=>{l(Ie(e,t,h,c()))});if(t.includes("fill")&&([void 0,null,""].includes(c())||at(e)&&Array.isArray(c())||e.tagName.toLowerCase()==="select"&&e.multiple)&&l(Ie(e,t,{target:e},c())),e._x_removeModelListeners||(e._x_removeModelListeners={}),e._x_removeModelListeners.default=d,r(()=>e._x_removeModelListeners.default()),e.form){let h=He(e.form,"reset",[],p=>{ot(()=>e._x_model&&e._x_model.set(Ie(e,t,{target:e},c())))});r(()=>h())}e._x_model={get(){return c()},set(h){l(h)}},e._x_forceModelUpdate=h=>{h===void 0&&typeof n=="string"&&n.match(/\./)&&(h=""),window.fromModel=!0,_(()=>_n(e,"value",h)),delete window.fromModel},i(()=>{let h=c();t.includes("unintrusive")&&document.activeElement.isSameNode(e)||e._x_forceModelUpdate(h)})});function Ie(e,t,n,i){return _(()=>{if(n instanceof CustomEvent&&n.detail!==void 0)return n.detail!==null&&n.detail!==void 0?n.detail:n.target.value;if(at(e))if(Array.isArray(i)){let r=null;return t.includes("number")?r=Re(n.target.value):t.includes("boolean")?r=pe(n.target.value):r=n.target.value,n.target.checked?i.includes(r)?i:i.concat([r]):i.filter(o=>!Zr(o,r))}else return n.target.checked;else{if(e.tagName.toLowerCase()==="select"&&e.multiple)return t.includes("number")?Array.from(n.target.selectedOptions).map(r=>{let o=r.value||r.text;return Re(o)}):t.includes("boolean")?Array.from(n.target.selectedOptions).map(r=>{let o=r.value||r.text;return pe(o)}):Array.from(n.target.selectedOptions).map(r=>r.value||r.text);{let r;return bn(e)?n.target.checked?r=n.target.value:r=i:r=n.target.value,t.includes("number")?Re(r):t.includes("boolean")?pe(r):t.includes("trim")?r.trim():r}}})}function Re(e){let t=e?parseFloat(e):null;return eo(t)?t:e}function Zr(e,t){return e==t}function eo(e){return!Array.isArray(e)&&!isNaN(e)}function Rt(e){return e!==null&&typeof e=="object"&&typeof e.get=="function"&&typeof e.set=="function"}w("cloak",e=>queueMicrotask(()=>_(()=>e.removeAttribute(q("cloak")))));dn(()=>`[${q("init")}]`);w("init",O((e,{expression:t},{evaluate:n})=>typeof t=="string"?!!t.trim()&&n(t,{},!1):n(t,{},!1)));w("text",(e,{expression:t},{effect:n,evaluateLater:i})=>{let r=i(t);n(()=>{r(o=>{_(()=>{e.textContent=o})})})});w("html",(e,{expression:t},{effect:n,evaluateLater:i})=>{let r=i(t);n(()=>{r(o=>{_(()=>{e.innerHTML=o,e._x_ignoreSelf=!0,P(e),delete e._x_ignoreSelf})})})});nt(en(":",tn(q("bind:"))));var Wn=(e,{value:t,modifiers:n,expression:i,original:r},{effect:o,cleanup:s})=>{if(!t){let c={};or(c),x(e,i)(u=>{En(e,u,r)},{scope:c});return}if(t==="key")return to(e,i);if(e._x_inlineBindings&&e._x_inlineBindings[t]&&e._x_inlineBindings[t].extract)return;let a=x(e,i);o(()=>a(c=>{c===void 0&&typeof i=="string"&&i.match(/\./)&&(c=""),_(()=>_n(e,t,c,n))})),s(()=>{e._x_undoAddedClasses&&e._x_undoAddedClasses(),e._x_undoAddedStyles&&e._x_undoAddedStyles()})};Wn.inline=(e,{value:t,modifiers:n,expression:i})=>{t&&(e._x_inlineBindings||(e._x_inlineBindings={}),e._x_inlineBindings[t]={expression:i,extract:!1})};w("bind",Wn);function to(e,t){e._x_keyExpression=t}un(()=>`[${q("data")}]`);w("data",(e,{expression:t},{cleanup:n})=>{if(no(e))return;t=t===""?"{}":t;let i={};De(i,e);let r={};ar(r,i);let o=D(e,t,{scope:r});(o===void 0||o===!0)&&(o={}),De(o,e);let s=z(o);Wt(s);let a=ie(e,s);s.init&&D(e,s.init),n(()=>{s.destroy&&D(e,s.destroy),a()})});be((e,t)=>{e._x_dataStack&&(t._x_dataStack=e._x_dataStack,t.setAttribute("data-has-alpine-state",!0))});function no(e){return R?Be?!0:e.hasAttribute("data-has-alpine-state"):!1}w("show",(e,{modifiers:t,expression:n},{effect:i})=>{let r=x(e,n);e._x_doHide||(e._x_doHide=()=>{_(()=>{e.style.setProperty("display","none",t.includes("important")?"important":void 0)})}),e._x_doShow||(e._x_doShow=()=>{_(()=>{e.style.length===1&&e.style.display==="none"?e.removeAttribute("style"):e.style.removeProperty("display")})});let o=()=>{e._x_doHide(),e._x_isShown=!1},s=()=>{e._x_doShow(),e._x_isShown=!0},a=()=>setTimeout(s),c=Ue(d=>d?s():o(),d=>{typeof e._x_toggleAndCascadeWithTransitions=="function"?e._x_toggleAndCascadeWithTransitions(e,d,s,o):d?a():o()}),l,u=!0;i(()=>r(d=>{!u&&d===l||(t.includes("immediate")&&(d?a():o()),c(d),l=d,u=!1)}))});w("for",(e,{expression:t},{effect:n,cleanup:i})=>{let r=ro(t),o=x(e,r.items),s=x(e,e._x_keyExpression||"index");e._x_prevKeys=[],e._x_lookup={},n(()=>io(e,r,o,s)),i(()=>{Object.values(e._x_lookup).forEach(a=>_(()=>{J(a),a.remove()})),delete e._x_prevKeys,delete e._x_lookup})});function io(e,t,n,i){let r=s=>typeof s=="object"&&!Array.isArray(s),o=e;n(s=>{oo(s)&&s>=0&&(s=Array.from(Array(s).keys(),f=>f+1)),s===void 0&&(s=[]);let a=e._x_lookup,c=e._x_prevKeys,l=[],u=[];if(r(s))s=Object.entries(s).map(([f,m])=>{let y=Tt(t,m,f,s);i(b=>{u.includes(b)&&M("Duplicate key on x-for",e),u.push(b)},{scope:{index:f,...y}}),l.push(y)});else for(let f=0;f<s.length;f++){let m=Tt(t,s[f],f,s);i(y=>{u.includes(y)&&M("Duplicate key on x-for",e),u.push(y)},{scope:{index:f,...m}}),l.push(m)}let d=[],h=[],p=[],v=[];for(let f=0;f<c.length;f++){let m=c[f];u.indexOf(m)===-1&&p.push(m)}c=c.filter(f=>!p.includes(f));let se="template";for(let f=0;f<u.length;f++){let m=u[f],y=c.indexOf(m);if(y===-1)c.splice(f,0,m),d.push([se,f]);else if(y!==f){let b=c.splice(f,1)[0],S=c.splice(y-1,1)[0];c.splice(f,0,S),c.splice(y,0,b),h.push([b,S])}else v.push(m);se=m}for(let f=0;f<p.length;f++){let m=p[f];m in a&&(_(()=>{J(a[m]),a[m].remove()}),delete a[m])}for(let f=0;f<h.length;f++){let[m,y]=h[f],b=a[m],S=a[y],U=document.createElement("div");_(()=>{S||M('x-for ":key" is undefined or invalid',o,y,a),S.after(U),b.after(S),S._x_currentIfEl&&S.after(S._x_currentIfEl),U.before(b),b._x_currentIfEl&&b.after(b._x_currentIfEl),U.remove()}),S._x_refreshXForScope(l[u.indexOf(y)])}for(let f=0;f<d.length;f++){let[m,y]=d[f],b=m==="template"?o:a[m];b._x_currentIfEl&&(b=b._x_currentIfEl);let S=l[y],U=u[y],Q=document.importNode(o.content,!0).firstElementChild,mt=z(S);ie(Q,mt,o),Q._x_refreshXForScope=Hn=>{Object.entries(Hn).forEach(([Jn,Qn])=>{mt[Jn]=Qn})},_(()=>{b.after(Q),O(()=>P(Q))()}),typeof U=="object"&&M("x-for key cannot be an object, it must be a string or an integer",o),a[U]=Q}for(let f=0;f<v.length;f++)a[v[f]]._x_refreshXForScope(l[u.indexOf(v[f])]);o._x_prevKeys=u})}function ro(e){let t=/,([^,\}\]]*)(?:,([^,\}\]]*))?$/,n=/^\s*\(|\)\s*$/g,i=/([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/,r=e.match(i);if(!r)return;let o={};o.items=r[2].trim();let s=r[1].replace(n,"").trim(),a=s.match(t);return a?(o.item=s.replace(t,"").trim(),o.index=a[1].trim(),a[2]&&(o.collection=a[2].trim())):o.item=s,o}function Tt(e,t,n,i){let r={};return/^\[.*\]$/.test(e.item)&&Array.isArray(t)?e.item.replace("[","").replace("]","").split(",").map(s=>s.trim()).forEach((s,a)=>{r[s]=t[a]}):/^\{.*\}$/.test(e.item)&&!Array.isArray(t)&&typeof t=="object"?e.item.replace("{","").replace("}","").split(",").map(s=>s.trim()).forEach(s=>{r[s]=t[s]}):r[e.item]=t,e.index&&(r[e.index]=n),e.collection&&(r[e.collection]=i),r}function oo(e){return!Array.isArray(e)&&!isNaN(e)}function qn(){}qn.inline=(e,{expression:t},{cleanup:n})=>{let i=ve(e);i._x_refs||(i._x_refs={}),i._x_refs[t]=e,n(()=>delete i._x_refs[t])};w("ref",qn);w("if",(e,{expression:t},{effect:n,cleanup:i})=>{e.tagName.toLowerCase()!=="template"&&M("x-if can only be used on a <template> tag",e);let r=x(e,t),o=()=>{if(e._x_currentIfEl)return e._x_currentIfEl;let a=e.content.cloneNode(!0).firstElementChild;return ie(a,{},e),_(()=>{e.after(a),O(()=>P(a))()}),e._x_currentIfEl=a,e._x_undoIf=()=>{_(()=>{J(a),a.remove()}),delete e._x_currentIfEl},a},s=()=>{e._x_undoIf&&(e._x_undoIf(),delete e._x_undoIf)};n(()=>r(a=>{a?o():s()})),i(()=>e._x_undoIf&&e._x_undoIf())});w("id",(e,{expression:t},{evaluate:n})=>{n(t).forEach(r=>Wr(e,r))});be((e,t)=>{e._x_ids&&(t._x_ids=e._x_ids)});nt(en("@",tn(q("on:"))));w("on",O((e,{value:t,modifiers:n,expression:i},{cleanup:r})=>{let o=i?x(e,i):()=>{};e.tagName.toLowerCase()==="template"&&(e._x_forwardEvents||(e._x_forwardEvents=[]),e._x_forwardEvents.includes(t)||e._x_forwardEvents.push(t));let s=He(e,t,n,a=>{o(()=>{},{scope:{$event:a},params:[a]})});r(()=>s())}));Ae("Collapse","collapse","collapse");Ae("Intersect","intersect","intersect");Ae("Focus","trap","focus");Ae("Mask","mask","mask");function Ae(e,t,n){w(t,i=>M(`You can't use [x-${t}] without first installing the "${e}" plugin here: https://alpinejs.dev/plugins/${n}`,i))}oe.setEvaluator(Gt);oe.setReactivityEngine({reactive:pt,effect:_r,release:yr,raw:g});var so=oe,gt=so;function ao(e){let t=()=>{let n,i;try{i=localStorage}catch(r){console.error(r),console.warn("Alpine: $persist is using temporary storage since localStorage is unavailable.");let o=new Map;i={getItem:o.get.bind(o),setItem:o.set.bind(o)}}return e.interceptor((r,o,s,a,c)=>{let l=n||`_x_${a}`,u=Ot(l,i)?kt(l,i):r;return s(u),e.effect(()=>{let d=o();$t(l,d,i),s(d)}),u},r=>{r.as=o=>(n=o,r),r.using=o=>(i=o,r)})};Object.defineProperty(e,"$persist",{get:()=>t()}),e.magic("persist",t),e.persist=(n,{get:i,set:r},o=localStorage)=>{let s=Ot(n,o)?kt(n,o):i();r(s),e.effect(()=>{let a=i();$t(n,a,o),r(a)})}}function Ot(e,t){return t.getItem(e)!==null}function kt(e,t){let n=t.getItem(e,t);if(n!==void 0)return JSON.parse(n)}function $t(e,t,n){n.setItem(e,JSON.stringify(t))}var co=ao;console.log("Main application script loaded");"serviceWorker"in navigator&&window.addEventListener("load",async()=>{try{const e=await navigator.serviceWorker.register("/sw.js");console.log("SW registered: ",e)}catch(e){console.log("SW registration failed: ",e)}});gt.plugin(co);window.Alpine=gt;gt.start();export{ae as _};
